<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é”™è¯¯å¤„ç†æµ‹è¯•</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: #f8fafc;
      padding: 20px;
      line-height: 1.6;
    }
    .test-container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      padding: 24px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    .error-section {
      margin-bottom: 24px;
      padding: 16px;
      border-radius: 8px;
    }
    .error-409 {
      background: #fff5f5;
      border: 1px solid #fed7d7;
    }
    .error-title {
      font-weight: 600;
      color: #e53e3e;
      margin-bottom: 8px;
    }
    .error-description {
      color: #4a5568;
      margin-bottom: 12px;
    }
    .fix-list {
      background: #f0fff4;
      border: 1px solid #9ae6b4;
      padding: 12px;
      border-radius: 6px;
    }
    .fix-list h4 {
      color: #2f855a;
      margin-bottom: 8px;
    }
    .fix-list ul {
      margin: 0;
      padding-left: 20px;
    }
    .fix-list li {
      color: #2d3748;
      margin-bottom: 4px;
    }
    .code-block {
      background: #f7fafc;
      border: 1px solid #e2e8f0;
      border-radius: 6px;
      padding: 12px;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      margin: 8px 0;
    }
  </style>
</head>
<body>
  <div class="test-container">
    <h1>HTTP 409 CONFLICT é”™è¯¯ä¿®å¤è¯´æ˜</h1>
    
    <div class="error-section error-409">
      <div class="error-title">ğŸš¨ é”™è¯¯ç°è±¡</div>
      <div class="error-description">
        å‰ç«¯è°ƒç”¨ <code>/api/generation/generate</code> æ—¶æ”¶åˆ° HTTP 409 CONFLICT é”™è¯¯
      </div>
      <div class="code-block">
        POST http://127.0.0.1:5000/api/generation/generate 409 (CONFLICT)<br>
        ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹å¤±è´¥: Error: HTTP 409: CONFLICT
      </div>
    </div>

    <div class="error-section">
      <div class="error-title">ğŸ” é—®é¢˜åˆ†æ</div>
      <div class="error-description">
        åç«¯ <code>/generation/generate</code> è·¯ç”±æ£€æŸ¥ä¼šè¯çŠ¶æ€å¿…é¡»ä¸º <code>'ready_to_generate'</code>ï¼š
      </div>
      <div class="code-block">
        # æ£€æŸ¥ä¼šè¯çŠ¶æ€<br>
        if session_data.get('status') != 'ready_to_generate':<br>
        &nbsp;&nbsp;&nbsp;&nbsp;return jsonify({<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'success': False,<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'error': 'session_error',<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'message': 'ä¼šè¯çŠ¶æ€ä¸æ­£ç¡®ï¼Œè¯·å…ˆå®Œæˆå¯¹è¯äº¤äº’'<br>
        &nbsp;&nbsp;&nbsp;&nbsp;}), 409
      </div>
    </div>

    <div class="fix-list">
      <h4>âœ… å·²å®æ–½çš„ä¿®å¤æªæ–½</h4>
      <ul>
        <li><strong>é˜²é‡å¤ç‚¹å‡»ï¼š</strong>æ·»åŠ  <code>isGenerating</code> çŠ¶æ€æ£€æŸ¥ï¼Œé˜²æ­¢é‡å¤è¯·æ±‚</li>
        <li><strong>æŒ‰é’®çŠ¶æ€ç®¡ç†ï¼š</strong>ç‚¹å‡»åç«‹å³ç¦ç”¨æŒ‰é’®ï¼Œæ˜¾ç¤º"ç”Ÿæˆä¸­..."</li>
        <li><strong>å»¶è¿Ÿæ˜¾ç¤ºæŒ‰é’®ï¼š</strong>æ£€æµ‹åˆ°ç”Ÿæˆå…³é”®è¯åå»¶è¿Ÿ500msæ˜¾ç¤ºæŒ‰é’®ï¼Œç¡®ä¿åç«¯çŠ¶æ€å·²æ›´æ–°</li>
        <li><strong>å‹å¥½é”™è¯¯æç¤ºï¼š</strong>409é”™è¯¯æ—¶æ˜¾ç¤º"ä¼šè¯çŠ¶æ€ä¸æ­£ç¡®ï¼Œè¯·ç¨ç­‰ç‰‡åˆ»åé‡è¯•"</li>
        <li><strong>çŠ¶æ€é‡ç½®ï¼š</strong>é”™è¯¯æ—¶æ­£ç¡®é‡ç½® <code>isGenerating</code> çŠ¶æ€</li>
        <li><strong>æ›´å¥½çš„é”™è¯¯è§£æï¼š</strong>å°è¯•è§£æåç«¯è¿”å›çš„å…·ä½“é”™è¯¯ä¿¡æ¯</li>
      </ul>
    </div>

    <div class="error-section">
      <div class="error-title">ğŸ”§ ä¿®å¤åçš„æµç¨‹</div>
      <div class="error-description">
        <ol>
          <li>ç”¨æˆ·ä¸AIå¯¹è¯ï¼ŒAIå›å¤åŒ…å«ç”Ÿæˆå…³é”®è¯</li>
          <li>å‰ç«¯æ£€æµ‹å…³é”®è¯ï¼Œå»¶è¿Ÿ500msåæ˜¾ç¤º"å¼€å§‹ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹"æŒ‰é’®</li>
          <li>ç”¨æˆ·ç‚¹å‡»æŒ‰é’®ï¼Œç«‹å³ç¦ç”¨å¹¶æ˜¾ç¤º"ç”Ÿæˆä¸­..."</li>
          <li>æ£€æŸ¥ <code>isGenerating</code> çŠ¶æ€ï¼Œé˜²æ­¢é‡å¤è¯·æ±‚</li>
          <li>è°ƒç”¨åç«¯APIï¼Œå¦‚æœ409é”™è¯¯åˆ™æ˜¾ç¤ºå‹å¥½æç¤º</li>
          <li>æˆåŠŸæˆ–å¤±è´¥åéƒ½æ­£ç¡®é‡ç½®çŠ¶æ€</li>
        </ol>
      </div>
    </div>

    <div class="error-section">
      <div class="error-title">ğŸ’¡ ä½¿ç”¨å»ºè®®</div>
      <div class="error-description">
        å¦‚æœä»ç„¶é‡åˆ°409é”™è¯¯ï¼Œè¯·ï¼š
        <ul>
          <li>ç­‰å¾…å‡ ç§’é’Ÿåé‡è¯•</li>
          <li>æ£€æŸ¥åç«¯æ—¥å¿—ç¡®è®¤ä¼šè¯çŠ¶æ€</li>
          <li>å¿…è¦æ—¶é‡æ–°å¼€å§‹å¯¹è¯æµç¨‹</li>
        </ul>
      </div>
    </div>
  </div>
</body>
</html>