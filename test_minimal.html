<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>最小化测试</title>
</head>
<body>
    <h1>最小化JavaScript测试</h1>
    <div id="test-output"></div>
    
    <!-- 模拟必要的DOM元素 -->
    <div id="chatMessages"></div>
    <input id="chatInput" type="text">
    <button id="sendBtn">发送</button>
    <div id="chatDisabledOverlay" class="hidden"></div>
    
    <script>
        // 模拟elements对象
        const elements = {
            chatMessages: document.getElementById('chatMessages'),
            chatInput: document.getElementById('chatInput'),
            sendBtn: document.getElementById('sendBtn'),
            chatDisabledOverlay: document.getElementById('chatDisabledOverlay')
        };
        
        // 模拟addMessage函数
        function addMessage(text, type) {
            console.log('addMessage called:', text, type);
            const div = document.createElement('div');
            div.textContent = text;
            elements.chatMessages.appendChild(div);
        }
        
        // 测试有问题的函数
        function initializeChatState() {
            console.log('initializeChatState called');
            
            if (elements.chatMessages) {
                elements.chatMessages.innerHTML = '';
                // 测试这行代码
                addMessage("你好！我是 AI 测试用例生成助手。请先在左侧上传您的用例模板文件并点击\"开始生成\"，然后我们就可以开始对话来生成完整的测试用例了。", "ai");
            }
        }
        
        // 执行测试
        try {
            initializeChatState();
            document.getElementById('test-output').innerHTML = '<p style="color: green;">✓ JavaScript语法正确，函数执行成功</p>';
        } catch (error) {
            console.error('JavaScript错误:', error);
            document.getElementById('test-output').innerHTML = '<p style="color: red;">✗ JavaScript错误: ' + error.message + '</p>';
        }
    </script>
</body>
</html>